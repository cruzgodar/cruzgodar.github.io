import{changeOpacity}from"../src/animation.min.js";import{$$,addTemporaryListener,addTemporaryParam,pageUrl}from"../src/main.min.js";import{redirect}from"../src/navigation.min.js";import{sitemap}from"../src/sitemap.min.js";import{Dropdown}from"./dropdowns.min.js";import{InputElement}from"./inputElement.min.js";class Button extends InputElement{linked;constructor({element,name,onClick,linked=!0}){super({element:element,name:name}),this.linked=linked,this.onClick=onClick,this.element.textContent=this.name,this.linked&&element.classList.add("linked-text-button"),this.element.addEventListener("click",e=>{this.disabled||this.onClick(e)}),equalizeTextButtons()}}class GenerateButton extends Button{constructor({element,onClick,linked=!0}){super({element:element,name:"Generate",onClick:onClick,linked:linked})}}class DownloadButton extends Button{constructor({element,linked=!0,applet,filename=()=>{}}){super({element:element,name:"Download",linked:linked,onClick:()=>{(applet.downloadFrame?applet:applet.wilson).downloadFrame(filename())}})}}class DownloadHighResButton extends Dropdown{constructor({element,applet,filename=()=>{}}){const e={"1k":1024,"2k":2048,"4k":4096,"8k":8128};super({element:element,name:"Download",options:{current:"Current","1k":"1K","2k":"2K","4k":"4K","8k":"8K"},roundCorners:!1,returnToTitleOnSelect:!0,onInput:function(){var t=e[this.value];(applet.downloadHighResFrame?applet:applet.wilson).downloadHighResFrame(filename(),t)}})}}class ToggleButton extends Button{state=!1;persistState;name0;name1;onClick0;onClick1;currentlyAnimating=!1;constructor({element,name0,name1,persistState=!0,onClick0,onClick1,linked=!0}){var t;super({element:element,name:name0,onClick:async()=>{var t;this.currentlyAnimating||(this.currentlyAnimating=!0,(this.state?this.onClick1:this.onClick0)(!1),this.state=!this.state,await changeOpacity({element:this.element,opacity:0}),this.element.textContent=this.state?this.name1:this.name0,this.persistState&&((t=new URLSearchParams(window.location.search)).set(this.element.id,this.state?"1":"0"),t=t.toString(),window.history.replaceState({url:pageUrl},"",pageUrl.replace(/\/home/,"")+"/"+(t?"?"+t:""))),await changeOpacity({element:this.element,opacity:1}),this.currentlyAnimating=!1)},linked:linked}),this.name0=name0,this.name1=name1,this.persistState=persistState,this.onClick0=onClick0,this.onClick1=onClick1,this.persistState?("1"===(t=new URLSearchParams(window.location.search).get(this.element.id))?setTimeout(()=>{this.setState({newState:!0,callOnInput:!0}),this.loadResolve()},10):"0"===t?setTimeout(()=>{this.setState({newState:!1,callOnInput:!0}),this.loadResolve()},10):this.loadResolve(),addTemporaryParam(this.element.id)):this.loadResolve()}async setState({newState,callOnInput=!1}){var t;this.state!==newState&&(this.state=newState,callOnInput&&(this.state?this.onClick1:this.onClick0)(!0),this.persistState&&((t=new URLSearchParams(window.location.search)).set(this.element.id,this.state?"1":"0"),t=t.toString(),window.history.replaceState({url:pageUrl},"",pageUrl.replace(/\/home/,"")+"/"+(t?"?"+t:""))),this.currentlyAnimating=!0,await changeOpacity({element:this.element,opacity:0}),this.element.textContent=this.state?this.name1:this.name0,await changeOpacity({element:this.element,opacity:1}),this.currentlyAnimating=!1)}}function initTextButtons(){addTemporaryListener({object:window,event:"resize",callback:equalizeTextButtons}),equalizeTextButtons(),setTimeout(equalizeTextButtons,50),setTimeout(equalizeTextButtons,500)}function equalizeTextButtons(){for(const c of $$(".text-button"))c.parentNode.style.margin="0 auto";var t=[];let e=0;var n=[];let i=0;var a,o,s,l,r=$$(".linked-text-button");for([a,o]of r.entries())o.style.height="fit-content",o.style.width="fit-content",t.push(o.offsetHeight),t[a]>e&&(e=t[a]),n.push(o.offsetWidth),n[a]>i&&(i=n[a]);for([s,l]of r.entries())t[s]<e?l.style.height=e+"px":l.style.height="fit-content",n[s]<i?l.style.width=i+"px":l.style.width="fit-content",l.parentNode.parentNode.style.gridTemplateColumns=`repeat(auto-fit, ${i}px)`}function initNavButtons(){if(sitemap[pageUrl].parent){const e=sitemap[sitemap[pageUrl].parent].children,n=e.indexOf(pageUrl);if(-1===n)console.error("Page not found in page list!");else{if(0<n)for(const i of $$(".previous-nav-button"))i.addEventListener("click",()=>redirect({url:e[n-1]}));else for(const a of $$(".previous-nav-button"))a.parentNode.remove();for(const o of $$(".home-nav-button"))o.addEventListener("click",()=>redirect({url:sitemap[pageUrl].parent}));if(n<e.length-1)for(const s of $$(".next-nav-button"))s.addEventListener("click",()=>redirect({url:e[n+1]}));else for(const l of $$(".next-nav-button"))l.parentNode.remove();var t=$$(".nav-buttons");t&&0<t.length&&(t[0].style.marginTop="0",t[0].style.marginBottom="32px")}}}export{Button,GenerateButton,DownloadButton,DownloadHighResButton,ToggleButton,initTextButtons,equalizeTextButtons,initNavButtons};