<header><div id="logo"><a href="/home" tabindex="-1"><img src="/graphics/general-icons/logo.webp" alt="Logo" tabindex="1"></img></a></div><div style="height: 20px"></div><h1 class="heading-text">Section 5: The Multivariable Chain Rule</h1></header><main><section><div id="show-solutions"></div><div class="text-buttons nav-buttons"><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button previous-nav-button" type="button" tabindex="-1">Previous</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button home-nav-button" type="button" tabindex="-1">Home</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button next-nav-button" type="button" tabindex="-1">Next</button></div></div><p class="body-text">We&#x2019;ve already been using the chain rule in multivariable calculus: <span class="tex-holder inline-math" data-source-tex="\frac{\partial}{\partial x}\left[ \sin\left( x^2y \right) \right] = \cos\left( x^2y \right)(2xy)">$\frac{\partial}{\partial x}\left[ \sin\left( x^2y \right) \right] = \cos\left( x^2y \right)(2xy)$</span> is a direct application of it. In symbols, if <span class="tex-holder inline-math" data-source-tex="x(t)">$x(t)$</span> is a function of <span class="tex-holder inline-math" data-source-tex="t">$t$</span> and <span class="tex-holder inline-math" data-source-tex="f(x)">$f(x)$</span> is a single-variable function of <span class="tex-holder inline-math" data-source-tex="x">$x$,</span> then we can write</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\frac{\text{d}f}{\text{d}t} = \frac{\text{d}f}{\text{d}x} \cdot \frac{\text{d}x}{\text{d}t}.[NEWLINE]$$">$$\begin{align*}\frac{\text{d}f}{\text{d}t} = \frac{\text{d}f}{\text{d}x} \cdot \frac{\text{d}x}{\text{d}t}.\end{align*}$$</span></p><p class="body-text">For a function of more than one variable, though, there can be more complicated things that happen. What if <span class="tex-holder inline-math" data-source-tex="f(x, y)">$f(x, y)$</span> is a function of multiple variables and both <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> are functions of <span class="tex-holder inline-math" data-source-tex="t">$t$?</span> Something like the chain rule ought to apply, but we&#x2019;ll need to dig a bit deeper to find out exactly what. To get a rough sense of what we&#x2019;re talking about, if <span class="tex-holder inline-math" data-source-tex="f(x, y) = \sin\left( x^2y \right)">$f(x, y) = \sin\left( x^2y \right)$</span> as before, but <span class="tex-holder inline-math" data-source-tex="x(t) = t^2">$x(t) = t^2$</span> and <span class="tex-holder inline-math" data-source-tex="y(t) = 1 - t">$y(t) = 1 - t$,</span> then</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]f(x(t), y(t)) = \sin\left( t^4(1 - t) \right) = \sin\left( t^4 - t^5 \right),[NEWLINE]$$">$$\begin{align*}f(x(t), y(t)) = \sin\left( t^4(1 - t) \right) = \sin\left( t^4 - t^5 \right),\end{align*}$$</span></p><p class="body-text">and so</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\frac{\text{d}f}{\text{d}t} = \cos\left( t^4 - t^5 \right)\left( 4t^3 - 5t^4 \right).[NEWLINE]$$">$$\begin{align*}\frac{\text{d}f}{\text{d}t} = \cos\left( t^4 - t^5 \right)\left( 4t^3 - 5t^4 \right).\end{align*}$$</span></p><p class="body-text">It&#x2019;s reasonable to say that that derivative depended on <em>both</em> <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$,</span> and specifically <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}x}{\text{d}t}">$\frac{\text{d}x}{\text{d}t}$</span> and <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}y}{\text{d}t}">$\frac{\text{d}y}{\text{d}t}$.</span> Let&#x2019;s return to the notion of a tangent plane to see how. When we found the equation</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]z = f(a, b) + f_x(a, b)(x - a) + f_y(a, b)(y - b)[NEWLINE]$$">$$\begin{align*}z = f(a, b) + f_x(a, b)(x - a) + f_y(a, b)(y - b)\end{align*}$$</span></p><p class="body-text">of the tangent plane to a function <span class="tex-holder inline-math" data-source-tex="f(x, y)">$f(x, y)$</span> at <span class="tex-holder inline-math" data-source-tex="(a, b)">$(a, b)$,</span> we effectively said that the approximate change in <span class="tex-holder inline-math" data-source-tex="z">$z$</span> when changing <span class="tex-holder inline-math" data-source-tex="x">$x$</span> by <span class="tex-holder inline-math" data-source-tex="\Delta x">$\Delta x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> by <span class="tex-holder inline-math" data-source-tex="\Delta y">$\Delta y$</span> is</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\Delta z \approx f_x(a, b)\Delta x + f_y(a, b)\Delta y;[NEWLINE]$$">$$\begin{align*}\Delta z \approx f_x(a, b)\Delta x + f_y(a, b)\Delta y;\end{align*}$$</span></p><p class="body-text">that is, we can track the <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> changes <em>separately</em>, and then just add them up. As a result, if we change a variable <span class="tex-holder inline-math" data-source-tex="t">$t$</span> that both <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> depend on, then we&#x2019;d expect <span class="tex-holder inline-math" data-source-tex="\Delta x">$\Delta x$</span> to be roughly <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}x}{\text{d}t}">$\frac{\text{d}x}{\text{d}t}$</span> and <span class="tex-holder inline-math" data-source-tex="\Delta y">$\Delta y$</span> to be roughly <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}y}{\text{d}t}">$\frac{\text{d}y}{\text{d}t}$.</span> While this is only an intuitive explanation, I think it goes a long way toward accepting the actual theorem statement.</p><div class="notes-thm notes-environment"><div class="notes-thm-title notes-title">The Multivariable Chain Rule for <span class="tex-holder inline-math" data-source-tex="\mathbf{z = f(x(t), y(t))}">$\mathbf{z = f(x(t), y(t))}$</span></div><p class="body-text">Let <span class="tex-holder inline-math" data-source-tex="z = f(x, y)">$z = f(x, y)$</span> be a differentiable function, and let <span class="tex-holder inline-math" data-source-tex="x = x(t)">$x = x(t)$</span> and <span class="tex-holder inline-math" data-source-tex="y = y(t)">$y = y(t)$</span> both be functions of the same variable. Then</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\frac{\text{d}z}{\text{d}t} = \frac{\partial z}{\partial x} \frac{\text{d}x}{\text{d}t} + \frac{\partial z}{\partial y} \frac{\text{d}y}{\text{d}t}.[NEWLINE]$$">$$\begin{align*}\frac{\text{d}z}{\text{d}t} = \frac{\partial z}{\partial x} \frac{\text{d}x}{\text{d}t} + \frac{\partial z}{\partial y} \frac{\text{d}y}{\text{d}t}.\end{align*}$$</span></p><p class="body-text">We can write this in a somewhat more cumbersome fashion as</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\frac{\text{d} f(x, y)}{\text{d} t} = \frac{\partial f}{\partial x} \frac{\text{d}x}{\text{d}t} + \frac{\partial f}{\partial y} \frac{\text{d}y}{\text{d}t}.[NEWLINE]$$">$$\begin{align*}\frac{\text{d} f(x, y)}{\text{d} t} = \frac{\partial f}{\partial x} \frac{\text{d}x}{\text{d}t} + \frac{\partial f}{\partial y} \frac{\text{d}y}{\text{d}t}.\end{align*}$$</span></p></div><p class="body-text">That second presentation of the theorem is definitely a little strange, but it&#x2019;s worth digging into for a moment. Writing <span class="tex-holder inline-math" data-source-tex="f(x, y)">$f(x, y)$</span> <em>looks</em> like we&#x2019;re evaluating a function completely, but since both <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> are functions of <span class="tex-holder inline-math" data-source-tex="t">$t$,</span> <span class="tex-holder inline-math" data-source-tex="f(x, y)">$f(x, y)$</span> is actually a function composition &mdash; and in particular, it&#x2019;s a function of <em>only one variable</em> (i.e. <span class="tex-holder inline-math" data-source-tex="t">$t$).</span> That&#x2019;s why it gets the usual <span class="tex-holder inline-math" data-source-tex="\text{d}">$\text{d}$</span> while the other derivatives get <span class="tex-holder inline-math" data-source-tex="\partial">$\partial$</span> symbols. To make this concrete, let&#x2019;s say <span class="tex-holder inline-math" data-source-tex="z = f(x, y)">$z = f(x, y)$</span> is a function giving elevation above sea level for a position <span class="tex-holder inline-math" data-source-tex="(x, y)">$(x, y)$,</span> and we&#x2019;re hiking on a path, so <span class="tex-holder inline-math" data-source-tex="(x, y)">$(x, y)$</span> changes over time as a function of a single variable <span class="tex-holder inline-math" data-source-tex="t">$t$.</span> When we compute <span class="tex-holder inline-math" data-source-tex="\frac{\partial z}{\partial x}">$\frac{\partial z}{\partial x}$</span> and <span class="tex-holder inline-math" data-source-tex="\frac{\partial z}{\partial y}">$\frac{\partial z}{\partial y}$,</span> we&#x2019;re finding out how steep the landscape is in the <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> directions, but when we compute <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}z}{\text{d}t}">$\frac{\text{d}z}{\text{d}t}$,</span> we&#x2019;re finding how fast <em>our</em> elevation changes over time as we hike along our path.</p><div class="notes-exc notes-environment"><div class="notes-exc-title notes-title">Exercise: the multivariable chain rule</div><p class="body-text">The pressure <span class="tex-holder inline-math" data-source-tex="P">$P$</span> of a gas is related to its temperature and volume by the <strong>ideal gas law</strong>: <span class="tex-holder inline-math" data-source-tex="PV = kT">$PV = kT$,</span> where <span class="tex-holder inline-math" data-source-tex="k">$k$</span> is a constant dependent on the quantity of gas. A gas with <span class="tex-holder inline-math" data-source-tex="k = 4">$k = 4$</span> is in an expanding container that is heating up. When the container is <span class="tex-holder inline-math" data-source-tex="10\, \text{cm}^3">$10\, \text{cm}^3$</span> large and at a temperature of <span class="tex-holder inline-math" data-source-tex="400\,\text{K}">$400\,\text{K}$,</span> and expanding at a rate of <span class="tex-holder inline-math" data-source-tex="3\,\frac{\text{cm}^3}{\text{s}}">$3\,\frac{\text{cm}^3}{\text{s}}$</span> and getting hotter at a rate of <span class="tex-holder inline-math" data-source-tex="2\,\frac{\text{K}}{\text{s}}">$2\,\frac{\text{K}}{\text{s}}$,</span> how fast is the pressure changing?</p><div class="solution"></div><p class="body-text">We&#x2019;re trying to find <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}P}{\text{d}t}">$\frac{\text{d}P}{\text{d}t}$,</span> but since we don&#x2019;t know <span class="tex-holder inline-math" data-source-tex="V">$V$</span> or <span class="tex-holder inline-math" data-source-tex="T">$T$</span> as functions of <span class="tex-holder inline-math" data-source-tex="t">$t$,</span> our only method of differentiation is the multivariable chain rule. We have <span class="tex-holder inline-math" data-source-tex="P = 4\frac{T}{V}">$P = 4\frac{T}{V}$,</span> so</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="\begin{align*}[NEWLINE][TAB]\frac{\text{d}P}{\text{d}t} &= \frac{\partial P}{\partial T} \frac{\text{d}T}{\text{d}t} + \frac{\partial P}{\partial V} \frac{\text{d}V}{\text{d}t}\\[NEWLINE][TAB]&= \left( \frac{4}{V} \right) \frac{\text{d}T}{\text{d}t} + \left( -4\frac{T}{V^2} \right) \frac{\text{d}V}{\text{d}t}.[NEWLINE]\end{align*}">$$\begin{align*}\frac{\text{d}P}{\text{d}t} &= \frac{\partial P}{\partial T} \frac{\text{d}T}{\text{d}t} + \frac{\partial P}{\partial V} \frac{\text{d}V}{\text{d}t}\\[4px]&= \left( \frac{4}{V} \right) \frac{\text{d}T}{\text{d}t} + \left( -4\frac{T}{V^2} \right) \frac{\text{d}V}{\text{d}t}.\end{align*}$$</span></p><p class="body-text">And we know all of these, at least at this one moment in time!</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="\begin{align*}[NEWLINE][TAB]\frac{\text{d}P}{\text{d}t} &= \left( \frac{4}{10} \right) \left( 2 \right) + \left( -4\frac{400}{100} \right) \left( 3 \right)\\[NEWLINE][TAB]&= 0.4 - 48.[NEWLINE]\end{align*}">$$\begin{align*}\frac{\text{d}P}{\text{d}t} &= \left( \frac{4}{10} \right) \left( 2 \right) + \left( -4\frac{400}{100} \right) \left( 3 \right)\\[4px]&= 0.4 - 48.\end{align*}$$</span></p></div><p class="body-text">This tells us how to handle functions of two variables, where each of those two variables depends on a third, but that&#x2019;s far from the only situation we can find ourselves in. Maybe <span class="tex-holder inline-math" data-source-tex="x">$x$</span> is a function <span class="tex-holder inline-math" data-source-tex="x(a, b, c)">$x(a, b, c)$</span> and <span class="tex-holder inline-math" data-source-tex="y">$y$</span> is a function <span class="tex-holder inline-math" data-source-tex="y(b, d)">$y(b, d)$,</span> and further, <span class="tex-holder inline-math" data-source-tex="c">$c$</span> is a function <span class="tex-holder inline-math" data-source-tex="c(t)">$c(t)$.</span> How do we evaluate <span class="tex-holder inline-math" data-source-tex="\frac{\text{d}f}{\text{d}t}">$\frac{\text{d}f}{\text{d}t}$</span> or <span class="tex-holder inline-math" data-source-tex="\frac{\partial f}{\partial b}">$\frac{\partial f}{\partial b}$?</span> The complexity threatens to spiral out of control here, so to get a better handle on the structure, let&#x2019;s draw the variables in a diagram.</p><div class="notes-images"><div class="notes-image invertible"></img><img src="/graphics/general-icons/placeholder.png" data-src="/teaching/yale/1180/notes/the-multivariable-chain-rule/graphics/tree-1.webp"></img></div><div class="notes-image invertible"></img><img src="/graphics/general-icons/placeholder.png" data-src="/teaching/yale/1180/notes/the-multivariable-chain-rule/graphics/tree-2.webp"></img></div></div><p class="body-text">Here, variables are connected by lines to the inputs they directly depend on &mdash; the first diagram is the situation we already described in the previous statement of this theorem, and the second is the hypothetical complex scenario we just mentioned. The multivariable chain rule in its full generality becomes much easier to state in terms of these tree diagrams! Rather than state it as a proper theorem, we&#x2019;ll just present it intuitively: to take the derivative of one variable with respect to another lower down in the diagram, first find <em>every</em> path from the top to the bottom. For each path, move down one segment at a time to build up a factor of partial derivatives of the top of each segment with respect to the bottom. Then add all of those factors up. For example, we can compute <span class="tex-holder inline-math" data-source-tex="\frac{\partial z}{\partial b}">$\frac{\partial z}{\partial b}$</span> by following the paths from <span class="tex-holder inline-math" data-source-tex="z">$z$</span> to <span class="tex-holder inline-math" data-source-tex="b">$b$:</span> one through <span class="tex-holder inline-math" data-source-tex="x">$x$</span> and one through <span class="tex-holder inline-math" data-source-tex="y">$y$.</span> The result is</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\frac{\partial z}{\partial b} = \frac{\partial z}{\partial x} \frac{\partial x}{\partial b} + \frac{\partial z}{\partial y} \frac{\partial y}{\partial b}.[NEWLINE]$$">$$\begin{align*}\frac{\partial z}{\partial b} = \frac{\partial z}{\partial x} \frac{\partial x}{\partial b} + \frac{\partial z}{\partial y} \frac{\partial y}{\partial b}.\end{align*}$$</span></p><div class="notes-exc notes-environment"><div class="notes-exc-title notes-title">Exercise: the multivariable chain rule</div><p class="body-text">A variable <span class="tex-holder inline-math" data-source-tex="w">$w$</span> is given by <span class="tex-holder inline-math" data-source-tex="w = f(x, y, z)">$w = f(x, y, z)$,</span> where <span class="tex-holder inline-math" data-source-tex="x = x(a, b)">$x = x(a, b)$,</span> <span class="tex-holder inline-math" data-source-tex="y = y(b)">$y = y(b)$,</span> and <span class="tex-holder inline-math" data-source-tex="z = z(b, c, s)">$z = z(b, c, s)$.</span> Moreover, <span class="tex-holder inline-math" data-source-tex="b = b(t, s)">$b = b(t, s)$</span> and <span class="tex-holder inline-math" data-source-tex="c = c(s)">$c = c(s)$.</span> Express <span class="tex-holder inline-math" data-source-tex="\frac{\partial w}{\partial s}">$\frac{\partial w}{\partial s}$</span> using the multivariable chain rule.</p><div class="solution"></div><p class="body-text">We end up with a rather nice-looking diagram:</p><div class="notes-images"><div class="notes-image invertible"></img><img src="/graphics/general-icons/placeholder.png" data-src="/teaching/yale/1180/notes/the-multivariable-chain-rule/graphics/tree-3.webp"></img></div></div><p class="body-text">The result is that</p><p class="body-text" style="text-align: center; line-height: 0"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\frac{\partial w}{\partial s} = \frac{\partial w}{\partial x} \frac{\partial x}{\partial b}\frac{\partial b}{\partial s} + \frac{\partial w}{\partial y} \frac{\text{d}y}{\text{d}b} \frac{\partial b}{\partial s} + \frac{\partial w}{\partial z} \frac{\partial z}{\partial b}\frac{\partial b}{\partial s} + \frac{\partial w}{\partial z} \frac{\partial z}{\partial c} \frac{\text{d}c}{\text{d}s} + \frac{\partial w}{\partial z} \frac{\partial z}{\partial s}.[NEWLINE]$$">$$\begin{align*}\frac{\partial w}{\partial s} = \frac{\partial w}{\partial x} \frac{\partial x}{\partial b}\frac{\partial b}{\partial s} + \frac{\partial w}{\partial y} \frac{\text{d}y}{\text{d}b} \frac{\partial b}{\partial s} + \frac{\partial w}{\partial z} \frac{\partial z}{\partial b}\frac{\partial b}{\partial s} + \frac{\partial w}{\partial z} \frac{\partial z}{\partial c} \frac{\text{d}c}{\text{d}s} + \frac{\partial w}{\partial z} \frac{\partial z}{\partial s}.\end{align*}$$</span></p></div><div class="text-buttons nav-buttons"><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button previous-nav-button" type="button" tabindex="-1">Previous</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button home-nav-button" type="button" tabindex="-1">Home</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button next-nav-button" type="button" tabindex="-1">Next</button></div></div></section></main>