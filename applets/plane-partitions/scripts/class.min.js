import{colorABConfigRegions,colorABConfigs,getArrayVersionOfABConfig,getMinimalABConfig,isValidABConfig,iterateThroughEntries,printABConfig,testAllEntriesOfABConfig}from"./abConfigs.min.js";import{addCube,addFloor,addLeftWall,addRightWall}from"./addGeometry.min.js";import{godar1,godar1Inverse}from"./algorithms/godar1.min.js";import{godar2}from"./algorithms/godar2.min.js";import{hillmanGrassl,hillmanGrasslInverse}from"./algorithms/hillmanGrassl.min.js";import{pak,pakInverse}from"./algorithms/pak.min.js";import{rsk,rskInverse}from"./algorithms/rsk.min.js";import{sulzgruber,sulzgruberInverse}from"./algorithms/sulzgruber.min.js";import{hideDimers,hideNumbersCanvas,show2dView,showDimers,showHexView,showNumbersCanvas,updateCameraHeight}from"./cameraControls.min.js";import{addNewArray,editArray,removeAllArrays,removeArray,trimArray}from"./editArrays.min.js";import{drawAll2dViewText,drawSingleCell2dViewText,hideFloor,hideWalls,recalculateHeights,removeOutsideFloor,showFloor,showWalls}from"./miscUtils.min.js";import{drawBoundary,drawBoundaryRect,drawNQuotient}from"./nQuotients.min.js";import{runAlgorithm,runExample}from"./runAlgorithm.min.js";import{colorCubes,colorWalls,deleteCubes,deleteFloor,lowerCubes,moveCubes,raiseCubes,revealCubes,uncolorCubes}from"./styleCubes.min.js";import{AnimationFrameApplet}from"/scripts/applets/animationFrameApplet.min.js";import{tempShader}from"/scripts/applets/applet.min.js";import{changeOpacity}from"/scripts/src/animation.min.js";import{convertColor}from"/scripts/src/browser.min.js";import{sleep}from"/scripts/src/utils.min.js";import*as THREE from"/scripts/three.min.js";import{WilsonCPU,WilsonGL}from"/scripts/wilson.min.js";class PlanePartitions extends AnimationFrameApplet{wilsonNumbers;wilsonHidden;wilsonHidden2;wilsonHidden3;wilsonHidden4;useFullscreenButton=!1;backgroundColor=0;resolution=2e3;animationTime=500;asymptoteLightness=.6;cubeLightness=.4;floorLightness=.4;infiniteHeight=50;addWalls=!1;abConfigMode=!1;wallWidth=16;wallHeight=16;scene;orthographicCamera;renderer;loader;cubeTexture;cubeTexture2;floorTexture;floorTexture2;cubeGeometry;floorGeometry;wallLeftGeometry;wallRightGeometry;ambientLight;dimersShown=!1;pointLight;in2dView=!1;inExactHexView=!0;currentlyAnimatingCamera=!1;currentlyRunningAlgorithm=!1;needDownload=!1;fontSize=10;arrays=[];totalArrayFootprint=0;totalArrayHeight=0;totalArraySize=0;hexViewCameraPos=[15,15,15];_2dViewCameraPos=[0,20,0];constructor({canvas,numbersCanvas,useFullscreenButton=!0,backgroundColor=0}){super(canvas),this.useFullscreenButton=useFullscreenButton,this.backgroundColor=backgroundColor;var e=this.createHiddenCanvas(),i=this.createHiddenCanvas(),r=this.createHiddenCanvas(),t=this.createHiddenCanvas(),s={shader:tempShader,canvasWidth:this.resolution,fullscreenOptions:{useFullscreenButton:this.useFullscreenButton,enterFullscreenButtonIconPath:"/graphics/general-icons/enter-fullscreen.png",exitFullscreenButtonIconPath:"/graphics/general-icons/exit-fullscreen.png",onSwitch:this.onSwitchFullscreen.bind(this),beforeSwitch:this.beforeSwitchFullscreen.bind(this)},verbose:window.DEBUG},s=(this.wilson=new WilsonGL(canvas,s),{canvasWidth:this.resolution,worldWidth:2,maxWorldY:1,minWorldY:-1,interactionOptions:{useForPanAndZoom:!0,disallowZooming:!0,onPanAndZoom:()=>this.needNewFrame=!0},fullscreenOptions:{animate:!1,closeWithEscape:!1},verbose:window.DEBUG}),s=(this.wilsonNumbers=new WilsonCPU(numbersCanvas,s),this.wilsonForFullscreen=this.wilson,this.wilsonNumbers.ctx.fillStyle=convertColor(255,255,255),setTimeout(()=>{var e=document.body.querySelectorAll(".WILSON_fullscreen-container");e[0].style.zIndex=200,e[1].style.zIndex=300,e[1].style.backgroundColor=convertColor(0,0,0,0)},50),this.wilsonNumbers.exitFullscreen(),{canvasWidth:64,verbose:window.DEBUG});this.wilsonHidden=new WilsonCPU(e,s),this.wilsonHidden2=new WilsonCPU(i,s),this.wilsonHidden3=new WilsonCPU(r,s),this.wilsonHidden4=new WilsonCPU(t,s),this.wilsonHidden.ctx.strokeStyle=convertColor(255,255,255,0),this.wilsonHidden.ctx._alpha=1,this.wilsonHidden.ctx.fillStyle=convertColor(64,64,64),this.wilsonHidden.ctx.fillRect(0,0,64,64),this.wilsonHidden.ctx.fillStyle=convertColor(128,128,128),this.wilsonHidden.ctx.fillRect(4,4,56,56),this.wilsonHidden.ctx.lineWidth=6,this.wilsonHidden2.ctx.strokeStyle=convertColor(255,255,255,0),this.wilsonHidden2.ctx._alpha=1,this.wilsonHidden2.ctx.fillStyle=convertColor(64,64,64),this.wilsonHidden2.ctx.fillRect(0,0,64,64),this.wilsonHidden2.ctx.fillStyle=convertColor(128,128,128),this.wilsonHidden2.ctx.fillRect(4,4,56,56),this.wilsonHidden2.ctx.lineWidth=6,this.wilsonHidden3.ctx.strokeStyle=convertColor(255,255,255,0),this.wilsonHidden3.ctx._alpha=1,this.wilsonHidden3.ctx.fillStyle=convertColor(32,32,32),this.wilsonHidden3.ctx.fillRect(0,0,64,64),this.wilsonHidden3.ctx.fillStyle=convertColor(64,64,64),this.wilsonHidden3.ctx.fillRect(4,4,56,56),this.wilsonHidden3.ctx.lineWidth=6,this.wilsonHidden4.ctx.strokeStyle=convertColor(255,255,255,0),this.wilsonHidden4.ctx._alpha=1,this.wilsonHidden4.ctx.fillStyle=convertColor(32,32,32,this.addWalls?1:0),this.wilsonHidden4.ctx.fillRect(0,0,64,64),this.wilsonHidden4.ctx.fillStyle=convertColor(64,64,64,this.addWalls?1:0),this.wilsonHidden4.ctx.fillRect(4,4,56,56),this.wilsonHidden4.ctx.lineWidth=6,this.scene=new THREE.Scene,this.scene.background=new THREE.Color(this.backgroundColor),this.orthographicCamera=new THREE.OrthographicCamera(-5,5,5,-5,.1,1e3),this.renderer=new THREE.WebGLRenderer({canvas:this.wilson.canvas,context:this.wilson.gl,alpha:!0}),this.renderer.setSize(this.resolution,this.resolution,!1),this.renderer.useLegacyLights=!0,this.loader=new THREE.TextureLoader,this.cubeTexture=new THREE.CanvasTexture(this.wilsonHidden.canvas),this.cubeTexture.minFilter=THREE.LinearFilter,this.cubeTexture.magFilter=THREE.NearestFilter,this.cubeTexture2=new THREE.CanvasTexture(this.wilsonHidden2.canvas),this.cubeTexture2.minFilter=THREE.LinearFilter,this.cubeTexture2.magFilter=THREE.NearestFilter,this.floorTexture=new THREE.CanvasTexture(this.wilsonHidden3.canvas),this.floorTexture.minFilter=THREE.LinearFilter,this.floorTexture.magFilter=THREE.NearestFilter,this.floorTexture2=new THREE.CanvasTexture(this.wilsonHidden4.canvas),this.floorTexture2.minFilter=THREE.LinearFilter,this.floorTexture2.magFilter=THREE.NearestFilter,this.cubeGeometry=new THREE.BoxGeometry,this.dimersShown=!1,this.floorGeometry=new THREE.BoxGeometry(1,.001,1),this.wallLeftGeometry=new THREE.BoxGeometry(.001,1,1),this.wallRightGeometry=new THREE.BoxGeometry(1,1,.001),this.ambientLight=new THREE.AmbientLight(16777215,.2),this.scene.add(this.ambientLight),this.pointLight=new THREE.PointLight(16777215,3,1e4),this.pointLight.position.set(750,1e3,500),this.scene.add(this.pointLight),this.resume()}drawFrame(){this.inExactHexView=0===this.wilsonNumbers.worldCenterX;for(const e of this.scene.children)e.rotation.y=-1.5*this.wilsonNumbers.worldCenterX;this.renderer.render(this.scene,this.orthographicCamera)}onSwitchFullscreen(isFullscreen){isFullscreen?(this.wilsonNumbers.enterFullscreen(),document.querySelectorAll(".WILSON_canvas-container")[0].appendChild(document.querySelector(".WILSON_exit-fullscreen-button"))):this.wilsonNumbers.exitFullscreen(),this.in2dView&&setTimeout(()=>{changeOpacity({element:this.wilsonNumbers.canvas,opacity:1,duration:this.animationTime/5})},300),this.resume()}isValidABConfig=isValidABConfig;getMinimalABConfig=getMinimalABConfig;iterateThroughEntries=iterateThroughEntries;printABConfig=printABConfig;testAllEntriesOfABConfig=testAllEntriesOfABConfig;getArrayVersionOfABConfig=getArrayVersionOfABConfig;colorABConfigRegions=colorABConfigRegions;colorABConfigs=colorABConfigs;addNewArray=addNewArray;editArray=editArray;trimArray=trimArray;removeArray=removeArray;removeAllArrays=removeAllArrays;addCube=addCube;addFloor=addFloor;addLeftWall=addLeftWall;addRightWall=addRightWall;showHexView=showHexView;show2dView=show2dView;showNumbersCanvas=showNumbersCanvas;hideNumbersCanvas=hideNumbersCanvas;updateCameraHeight=updateCameraHeight;showDimers=showDimers;hideDimers=hideDimers;showFloor=showFloor;hideFloor=hideFloor;showWalls=showWalls;hideWalls=hideWalls;removeOutsideFloor=removeOutsideFloor;recalculateHeights=recalculateHeights;drawAll2dViewText=drawAll2dViewText;drawSingleCell2dViewText=drawSingleCell2dViewText;colorCubes=colorCubes;uncolorCubes=uncolorCubes;colorWalls=colorWalls;raiseCubes=raiseCubes;lowerCubes=lowerCubes;moveCubes=moveCubes;revealCubes=revealCubes;deleteCubes=deleteCubes;deleteFloor=deleteFloor;drawBoundary=drawBoundary;drawNQuotient=drawNQuotient;drawBoundaryRect=drawBoundaryRect;runExample=runExample;runAlgorithm=runAlgorithm;hillmanGrassl=hillmanGrassl;hillmanGrasslInverse=hillmanGrasslInverse;pak=pak;pakInverse=pakInverse;sulzgruber=sulzgruber;sulzgruberInverse=sulzgruberInverse;rsk=rsk;rskInverse=rskInverse;godar1=godar1;godar1Inverse=godar1Inverse;godar2=godar2;algorithmData={hillmanGrassl:{method:this.hillmanGrassl,inputType:["pp"]},hillmanGrasslInverse:{method:this.hillmanGrasslInverse,inputType:["tableau"]},pak:{method:this.pak,inputType:["pp"]},pakInverse:{method:this.pakInverse,inputType:["tableau"]},sulzgruber:{method:this.sulzgruber,inputType:["pp"]},sulzgruberInverse:{method:this.sulzgruberInverse,inputType:["tableau"]},rsk:{method:this.rsk,inputType:["ssyt","ssyt"],sameShape:!0},rskInverse:{method:this.rskInverse,inputType:["tableau"]},godar1:{method:this.godar1,inputType:["pp"]},godar1Inverse:{method:this.godar1Inverse,inputType:["pp","pp"]},godar2:{method:this.godar2,inputType:["pp"]}};async beforeSwitchFullscreen(){this.pause(),this.in2dView&&await changeOpacity({element:this.wilsonNumbers.canvas,opacity:0,duration:this.animationTime/5}),await sleep(33)}}export{PlanePartitions};